<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Painel Admin - Jogos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
      * {
        box-sizing: border-box;
        font-family: Arial, sans-serif;
      }

      body {
        margin: 0;
        min-height: 100vh;
        background: #0f172a;
        color: #fff;
        display: grid;
        grid-template-columns: 300px 1fr;
      }

      /* SIDEBAR */
      .sidebar {
        background: #020617;
        border-right: 1px solid #1e293b;
        padding: 20px;
        overflow-y: auto;
      }

      .sidebar h2 {
        margin-bottom: 15px;
        font-size: 20px;
      }

      .game-item {
        background: #1e293b;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: 0.2s;
      }

      .game-item:hover {
        background: #2563eb;
      }

      .actions {
        margin-top: 20px;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      button {
        padding: 10px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
      }

      .btn-add {
        background: #16a34a;
        color: #fff;
      }
      .btn-save {
        background: #2563eb;
        color: #fff;
      }
      .btn-delete {
        background: #dc2626;
        color: #fff;
      }
      .btn-import {
        background: #9333ea;
        color: #fff;
      }

      /* CONTE√öDO */
      .content {
        padding: 30px;
        overflow-y: auto;
      }

      .content h1 {
        margin-bottom: 20px;
      }

      .form {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        max-width: 900px;
      }

      .form label {
        display: flex;
        flex-direction: column;
        font-size: 14px;
        gap: 5px;
      }

      .form input,
      .form textarea {
        padding: 8px;
        border-radius: 6px;
        border: none;
        outline: none;
      }

      textarea {
        resize: vertical;
        min-height: 80px;
      }

      .full {
        grid-column: span 2;
      }

      .preview {
        margin-top: 20px;
        background: #020617;
        padding: 20px;
        border-radius: 10px;
        max-width: 500px;
      }

      .preview img {
        width: 100%;
        border-radius: 10px;
        margin-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <!-- SIDEBAR -->
    <div class="sidebar">
      <h2>Jogos</h2>
      <div id="game-list"></div>

      <div class="actions">
        <button class="btn-add" onclick="newGame()">‚ûï Novo Jogo</button>
        <button class="btn-save" onclick="exportJSON()">
          üíæ Baixar games.json
        </button>
        <button class="btn-delete" onclick="deleteGame()">
          üóëÔ∏è Excluir Jogo
        </button>
        <button class="btn-import" onclick="importJSON()">
          üìÇ Importar JSON
        </button>
        <input type="file" id="fileInput" hidden accept="application/json" />
      </div>
    </div>

    <!-- CONTE√öDO -->
    <div class="content">
      <h1>Editor de Jogo</h1>

      <div class="form">
        <label
          >Slug (ID)
          <input id="id" />
        </label>

        <label
          >T√≠tulo
          <input id="titulo" />
        </label>

        <label
          >Desenvolvedora
          <input id="desenvolvedora" />
        </label>

        <label
          >Ano
          <input id="ano" type="number" />
        </label>

        <label
          >G√™nero
          <input id="genero" />
        </label>

        <label
          >Nota
          <input id="nota" type="number" step="0.1" />
        </label>

        <label class="full"
          >Plataformas (separadas por v√≠rgula)
          <input id="plataformas" />
        </label>

        <label class="full"
          >Imagem (URL)
          <input id="imagem" />
        </label>

        <label class="full"
          >Descri√ß√£o
          <textarea id="descricao"></textarea>
        </label>
      </div>

      <div class="preview" id="preview"></div>
    </div>

    <script>
      let games = [];
      let selectedIndex = null;

      // Carrega o JSON inicial
      fetch("games.json")
        .then((r) => r.json())
        .then((data) => {
          games = data;
          renderList();
        })
        .catch(() => {
          games = [];
          renderList();
        });

      function renderList() {
        const list = document.getElementById("game-list");
        list.innerHTML = "";

        games.forEach((game, index) => {
          const div = document.createElement("div");
          div.className = "game-item";
          div.textContent = game.titulo;
          div.onclick = () => selectGame(index);
          list.appendChild(div);
        });
      }

      function selectGame(index) {
        selectedIndex = index;
        const g = games[index];

        id.value = g.id;
        titulo.value = g.titulo;
        desenvolvedora.value = g.desenvolvedora;
        ano.value = g.ano;
        genero.value = g.genero;
        nota.value = g.nota;
        plataformas.value = g.plataformas.join(", ");
        imagem.value = g.imagem;
        descricao.value = g.descricao;

        renderPreview();
      }

      document.querySelectorAll("input, textarea").forEach((el) => {
        el.addEventListener("input", updateGame);
      });

      function updateGame() {
        if (selectedIndex === null) return;

        games[selectedIndex] = {
          id: id.value,
          titulo: titulo.value,
          desenvolvedora: desenvolvedora.value,
          ano: Number(ano.value),
          genero: genero.value,
          nota: Number(nota.value),
          plataformas: plataformas.value.split(",").map((p) => p.trim()),
          imagem: imagem.value,
          descricao: descricao.value,
        };

        renderList();
        renderPreview();
      }

      function renderPreview() {
        if (selectedIndex === null) return;
        const g = games[selectedIndex];

        preview.innerHTML = `
        <img src="${g.imagem}" />
        <h3>${g.titulo}</h3>
        <p>${g.descricao}</p>
        <p><strong>Nota:</strong> ${g.nota}</p>
      `;
      }

      function newGame() {
        const novo = {
          id: "novo_jogo",
          titulo: "Novo Jogo",
          desenvolvedora: "",
          ano: 2025,
          genero: "",
          nota: 0,
          plataformas: [],
          imagem: "",
          descricao: "",
        };

        games.push(novo);
        renderList();
        selectGame(games.length - 1);
      }

      function deleteGame() {
        if (selectedIndex === null) return;
        if (!confirm("Deseja realmente excluir este jogo?")) return;

        games.splice(selectedIndex, 1);
        selectedIndex = null;
        renderList();
        preview.innerHTML = "";
        document
          .querySelectorAll("input, textarea")
          .forEach((el) => (el.value = ""));
      }

      function exportJSON() {
        const blob = new Blob([JSON.stringify(games, null, 2)], {
          type: "application/json",
        });
        const url = URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "games.json";
        a.click();

        URL.revokeObjectURL(url);
      }

      function importJSON() {
        fileInput.click();

        fileInput.onchange = (e) => {
          const file = e.target.files[0];
          const reader = new FileReader();

          reader.onload = (ev) => {
            games = JSON.parse(ev.target.result);
            selectedIndex = null;
            renderList();
            preview.innerHTML = "";
          };

          reader.readAsText(file);
        };
      }
    </script>
  </body>
</html>
